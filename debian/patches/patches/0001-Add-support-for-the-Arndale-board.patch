From 219a781dce3e7d78e3ec0215850fc5e832195b78 Mon Sep 17 00:00:00 2001
From: Ian Campbell <ijc@debian.org>
Date: Sun, 28 Sep 2014 15:31:55 +0100
Subject: [PATCH 1/3] Add support for the Arndale board.

As well as the additional target this required adding a build-depends on the
device tree compiler as well as a patch to support "make spl/$(BOARD)-spl.bin"
from the top-level directory which is required by the current debian/rules
file.
---
 debian/changelog                   |  7 +++++++
 debian/control                     |  2 +-
 debian/patches/board-spl-rule.diff | 17 +++++++++++++++++
 debian/patches/series              |  1 +
 debian/targets                     |  3 +++
 5 files changed, 29 insertions(+), 1 deletion(-)
 create mode 100644 debian/patches/board-spl-rule.diff

diff --git a/debian/changelog b/debian/changelog
index 2d14e23..52e5e0a 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,10 @@
+u-boot (2014.10~rc2+dfsg1-2~exp2) UNRELEASED; urgency=medium
+
+  [ Ian Campbell ]
+  * Add support for the Arndale board.
+
+ -- Ian Campbell <ijc@debian.org>  Sat, 27 Sep 2014 09:48:00 +0100
+
 u-boot (2014.10~rc2+dfsg1-2~exp1) experimental; urgency=medium
 
   * Split u-boot package into u-boot-imx, u-boot-omap and u-boot-sunxi
diff --git a/debian/control b/debian/control
index 82d3614..f0b18b2 100644
--- a/debian/control
+++ b/debian/control
@@ -3,7 +3,7 @@ Section: admin
 Priority: optional
 Maintainer: Vagrant Cascadian <vagrant@debian.org>
 Uploaders: Lo√Øc Minier <lool@debian.org>, Clint Adams <clint@debian.org>
-Build-Depends: debhelper (>= 9), bc
+Build-Depends: debhelper (>= 9), bc, device-tree-compiler
 Standards-Version: 3.9.5
 Homepage: http://www.denx.de/wiki/U-Boot/
 Vcs-Git: git://anonscm.debian.org/collab-maint/u-boot.git
diff --git a/debian/patches/board-spl-rule.diff b/debian/patches/board-spl-rule.diff
new file mode 100644
index 0000000..e2cf895
--- /dev/null
+++ b/debian/patches/board-spl-rule.diff
@@ -0,0 +1,17 @@
+Description: Enable generic spl/$(BOARD)-spl.bin rule
+Author: Ian Campbell <ijc@debian.org>
+
+Needed for spl/arndale-spl.bin
+
+--- a/Makefile
++++ b/Makefile
+@@ -1142,6 +1142,9 @@
+ spl/sunxi-spl.bin: spl/u-boot-spl
+ 	@:
+ 
++spl/$(BOARD)-spl.bin: spl/u-boot-spl
++	@:
++
+ tpl/u-boot-tpl.bin: tools prepare
+ 	$(Q)$(MAKE) obj=tpl -f $(srctree)/scripts/Makefile.spl all
+ 
diff --git a/debian/patches/series b/debian/patches/series
index fa6f558..ff5e2a6 100644
--- a/debian/patches/series
+++ b/debian/patches/series
@@ -22,3 +22,4 @@ workaround-env-ftbfs
 
 sunxi/0001-sun7i-Add-support-for-Olimex-A20-OLinuXino-LIME.patch
 tools-generic-builds.patch
+board-spl-rule.diff
diff --git a/debian/targets b/debian/targets
index f0c2472..8b6d825 100644
--- a/debian/targets
+++ b/debian/targets
@@ -78,6 +78,9 @@ armhf	imx		wandboard_solo	u-boot.imx
 # Hector Oron <zumbi@debian.org>
 armhf	imx		nitrogen6q	u-boot.imx
 
+# Ian Campbell <ijc@hellion.org.uk>
+armhf	-		arndale		u-boot-dtb.bin spl/arndale-spl.bin
+
 avr32	-		hammerhead	u-boot.img
 
 mips	-		dbau1100	u-boot.img
-- 
2.1.0

