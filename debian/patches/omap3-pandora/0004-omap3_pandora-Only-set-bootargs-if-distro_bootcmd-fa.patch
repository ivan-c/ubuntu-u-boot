From 6a7981a7235a8a3f6b58c596e6afe9f683324043 Mon Sep 17 00:00:00 2001
From: Vagrant Cascadian <vagrant@debian.org>
Date: Mon, 29 Aug 2016 16:37:38 -0700
Subject: [PATCH 4/4] omap3_pandora: Only set bootargs if distro_bootcmd failed
 to load.

---
 include/configs/omap3_pandora.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/include/configs/omap3_pandora.h b/include/configs/omap3_pandora.h
index 0aa45f5..6a0714f 100644
--- a/include/configs/omap3_pandora.h
+++ b/include/configs/omap3_pandora.h
@@ -88,6 +88,7 @@
 
 #define CONFIG_BOOTCOMMAND \
 	"run distro_bootcmd; " \
+	"setenv bootargs ${bootargs_ubi}; " \
 	"if mmc rescan && load mmc 0:1 ${loadaddr} autoboot.scr; then " \
 		"source ${loadaddr}; " \
 	"fi; " \
@@ -102,7 +103,7 @@
 #define CONFIG_EXTRA_ENV_SETTINGS \
 	DEFAULT_LINUX_BOOT_ENV \
 	"usbtty=cdc_acm\0" \
-	"bootargs=ubi.mtd=4 ubi.mtd=3 root=ubi0:rootfs rootfstype=ubifs " \
+	"bootargs_ubi=ubi.mtd=4 ubi.mtd=3 root=ubi0:rootfs rootfstype=ubifs " \
 		"rw rootflags=bulk_read vram=6272K omapfb.vram=0:3000K\0" \
 	"mtdparts=" MTDPARTS_DEFAULT "\0" \
 	BOOTENV \
-- 
2.9.3

